<dashboard>
  <label>Indicators</label>
  <search id="sioc_lookup">
    <query>| inputlookup sioc_lookup</query>
  </search>
  <row>
    <panel>
      <title>Total Indicators</title>
      <single>
        <search base="sioc_lookup">
          <query>stats count</query>
        </search>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <link target="_blank">search?q=| inputlookup sioc_lookup | rename indicator_created as "Created at", indicator_pattern as Pattern, indicator_indicator_types as "Indicator Types" , indicator_kill_chain_phases as "Kill Chain Phases" |  table "Created at", Pattern, "Indicator Types", "Kill Chain Phases"</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <title>Total Indicators With Sightings</title>
      <single>
        <search base="sioc_lookup">
          <query>where match_count &gt; 0 | stats count</query>
        </search>
        <option name="drilldown">all</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <link target="_blank">search?q=| inputlookup sioc_lookup | where match_count &gt; 0 | eval match_first_seen=strftime(match_first_seen,"%Y-%m-%dT%H:%M:%S.%Q"), match_last_seen=strftime(match_last_seen,"%Y-%m-%dT%H:%M:%S.%Q") | rename indicator_name as Info, indicator_indicator_types as "Indicator Types" , indicator_kill_chain_phases as "Kill Chain Phases", match_count as "Sightings", match_indexes as "Indexes", match_first_seen as "First Seen", match_last_seen as "Last Seen" |  table Info, "Indicator Types", "Kill Chain Phases", "Sightings", "Indexes", "First Seen", "Last Seen"</link>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Total Indicators Searched Last 24 hours</title>
      <single>
        <search base="sioc_lookup">
          <query>eval start_time=relative_time(now(), "-24h") |  where triggered_at &gt; start_time | stats count</query>
        </search>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <link target="_blank">search?q=| inputlookup sioc_lookup | eval start_time=relative_time(now(), "-24h") |  where triggered_at &gt; start_time | eval "Triggered at"=strftime(triggered_at,"%Y-%m-%dT%H:%M:%S.%Q") | rename ndicator_created as "Created at", indicator_pattern as Pattern, indicator_indicator_types as "Indicator Types" , indicator_kill_chain_phases as "Kill Chain Phases", |  table "Created at", Pattern, "Indicator Types", "Kill Chain Phases"</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <title>Total Indicators With Sightings Searched Last 24 hours</title>
      <single>
        <search base="sioc_lookup">
          <query>eval start_time=relative_time(now(), "-24h") |  where triggered_at &gt; start_time AND match_count &gt; 0 | stats count</query>
        </search>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <link target="_blank">search?q=| inputlookup sioc_lookup | eval start_time=relative_time(now(), "-24h") |  where triggered_at &gt; start_time AND match_count &gt; 0 | eval "Triggered at"=strftime(triggered_at,"%Y-%m-%dT%H:%M:%S.%Q") | rename ndicator_created as "Created at", indicator_pattern as Pattern, indicator_indicator_types as "Indicator Types" , indicator_kill_chain_phases as "Kill Chain Phases", |  table "Created at", Pattern, "Indicator Types", "Kill Chain Phases"</link>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top 10 Indicators By Sightings</title>
      <table>
        <search base="sioc_lookup">
          <query>|  sort - match_count limit=10 |  eval match_first_seen=strftime(match_first_seen,"%Y-%m-%dT%H:%M:%S.%Q"), match_last_seen=strftime(match_last_seen,"%Y-%m-%dT%H:%M:%S.%Q") | rename indicator_name as Info, indicator_indicator_types as "Indicator Types" , indicator_kill_chain_phases as "Kill Chain Phases", match_count as "Sightings", match_indexes as "Indexes", match_first_seen as "First Seen", match_last_seen as "Last Seen" |  table Info, "Indicator Types", "Kill Chain Phases", "Sightings", "Indexes", "First Seen", "Last Seen"</query>
        </search>
        <option name="refresh.display">progressbar</option>
        <fields>Info, "Indicator Types", "Kill Chain Phases", "Sightings", "Indexes", "First Seen", "Last Seen"</fields>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Indicators Type Distribution</title>
      <chart>
        <search base="sioc_lookup">
          <query>stats count by indicator_indicator_types</query>
        </search>
        <option name="charting.chart">pie</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <title>Indicators With Sightings Type Distribution</title>
      <chart>
        <search base="sioc_lookup">
          <query>where match_count &gt; 0 |stats count by indicator_indicator_types</query>
        </search>
        <option name="charting.chart">pie</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
</dashboard>
